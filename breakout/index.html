<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="utf-8">
    <title>Breakout klon</title>
    <script src="js/phaser.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>
    <script>
        /* Skapa tom spelmotor */
        var spel = new Phaser.Game(500, 400, Phaser.AUTO, null, {
            preload: ladda,
            create: bygga,
            update: loop
        });

        /* Globala variabler */
        var boll, sovjet, bas;

        /* Här hämtar vi in grafiken */
        function ladda() {

            /* Anpassar skalan till skärmen och centrerar */
            spel.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            spel.scale.pageAlignHorizontally = true;
            spel.scale.pageAlignVertically = true;

            /* Sätter bakgrundsfärgen */
            spel.stage.backgroundColor = '#aec6d3';

            /* Ladda grafiken till bollen */
            spel.load.image('boll', 'bilder/ball.png');
            spel.load.image('sovjet', 'bilder/sovjet.png');
            spel.load.image('bas', 'bilder/paddle.png');
        }

        /* Här bygger vi spelytan */
        function bygga() {

            /* Slå på riktig fysikaliska lagar */
            spel.physics.startSystem(Phaser.Physics.ARCADE);

            /* Rita ut grafiken */
            boll = spel.add.sprite(50, 50, 'boll');
            sovjet = spel.add.sprite(100, 100, 'sovjet');
            bas = spel.add.sprite(spel.world.width/2, spel.world.height-50, 'bas');
            bas.anchor.set(0.5, 1);

            //sovjet.scale.setTo(50, 50);

            /* Ge bollen fysikaliska egenskaper */
            spel.physics.enable(boll, Phaser.Physics.ARCADE);

            /* Gör att vi kan kollidera med väggarna */
            boll.body.collideWorldBounds = true;

            /* Gör att bollen studsar */
            boll.body.bounce.set(1);

            /* Ge bollen gravitation */
            boll.body.gravity.y = 100;

            /* Ge bollen en spark */
            boll.body.velocity.set(100, -50);

            spel.physics.enable(sovjet, Phaser.Physics.ARCADE);
//            sovjet.body.collideWorldBounds = true;
//            sovjet.body.bounce.set(1);
//            sovjet.body.gravity.y = 100;
//            sovjet.body.velocity.set(100, -50);

            /* Ge bas fysikaliska egenskaper */
            spel.physics.enable(bas, Phaser.Physics.ARCADE);

            /* Men bas måste förbli orörlig */
            bas.body.immovable = true;

        }

        /* Här är koden till spelet */
        function loop() {
//            spel.physics.arcade.collide(boll, sovjet);
            spel.physics.arcade.collide(boll, bas);

            /* Koppla in musen på bas */
            //bas.x = spel.input.x;

            /* Flytta ett steg åt höger när vi trycker pil-höger */
            if (spel.input.keyboard.isDown(Phaser.Keyboard.RIGHT)) {
                bas.x += 5;
            }

            /* Flytta ett steg åt vänster när vi trycker pil-vänster */
            if (spel.input.keyboard.isDown(Phaser.Keyboard.LEFT)) {
                bas.x -= 5;
            }

        }
    </script>
</body>

</html>
